# Multitask Learning

## Data Generation
Synthetic data can be generate by running the file format_data_synthetic.py. 
    ```
    python format_data_synthetic.py --d1=100 --d2=50 --d3=50 --r=10
    ```
This creates meta-train (X,Y,Z,R,task_function) and meta-test datasets in the folder data/synthetic. The meta-test dataset is generated by varying N2 for different values (20 to 200) for 20 different trials.

Similarly, running format_data_school.ipynb (or format_data_lenk.ipynb) creates meta-train and meta-test datasets for Schools (resp. Lenk). Because we do not know the true model, evaluation sets are also added.

## Meta-Test (N2 Experiments)
There are two types of files for running meta-test experiments. (1) N2_meta_test_tensor_<data>.py and (2) N2_meta_test_matrix_<data>.py Here <data> should be replaced by one of synthetic, lenk, and school. The first file (1) runs tensor regression (method I) and method of moments (method II) and can be specified by the method flag.
    ```
    python N2_meta_test_tensor_synthetic.py --method=I
    ```
The second file (2) on the other hand, runs two different types of matrix methods -- d1d2 x d3 (method I) and (d1+d2) x d3 (method II)
    ```
    python N2_meta_test_matrix_synthetic.py --method=II
    ```
 

